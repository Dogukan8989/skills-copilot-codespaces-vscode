<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ayarlar | SocialBook</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="style.css" rel="stylesheet">
</head>
<body>

    <nav class="navbar navbar-light bg-light shadow-sm sticky-top d-md-none">
        <div class="container-fluid">
            <span class="navbar-brand text-primary">AYARLAR</span>
            <button id="sidebarToggleMobile" class="btn btn-primary"><i class="fas fa-bars"></i></button>
        </div>
    </nav>

    <div id="social-app-wrapper">
        
        <div class="sidebar d-print-block">
            <h4 class="mb-4 text-center text-primary">SOCIALBOOK</h4>
            <div class="user-info-card mx-3 mb-4 text-center">
                <img src="" id="sidebarUserAvatar" class="rounded-circle mb-2 border" style="width: 60px; height: 60px; object-fit: cover;">
                <p class="mb-0 fw-bold text-white" id="mainUserName"></p>
                <span class="badge bg-primary" id="userRoleBadge"></span>
            </div>
            
            <ul class="nav flex-column mb-auto">
                <li class="nav-item"><a class="nav-link" href="social_media_main.html"><i class="fas fa-home me-2"></i> Ana Sayfa</a></li>
                <li class="nav-item"><a class="nav-link" href="profile.html"><i class="fas fa-user me-2"></i> Profilim</a></li>
                <li class="nav-item"><a class="nav-link active" href="settings.html"><i class="fas fa-cog me-2"></i> Ayarlar</a></li>
                <li class="nav-item"><a class="nav-link" href="messages.html"><i class="fas fa-envelope me-2"></i> Mesajlar</a></li>
                
                <li class="nav-item mb-2">
                    <a class="nav-link text-dark" onclick="openFriendsModal()"> 
                        <i class="fas fa-users me-2"></i> Arkadaşlarım / Ara
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="index.html" id="adminPanelLink"><i class="fas fa-shield-alt me-2"></i> Admin Panel</a>
                </li>
            </ul>
            <div class="p-3 text-center position-absolute bottom-0 start-0 w-100">
                <button id="siteLogoutBtn" class="btn btn-danger w-75" onclick="logout()"><i class="fas fa-sign-out-alt me-1"></i> Çıkış Yap</button>
            </div>
        </div>

        <div class="main-content-wrapper">
            <div class="content-area container-fluid p-4">
                <h1 class="mb-4 text-primary"><i class="fas fa-cog me-2"></i> Hesap Ayarları</h1>

                <div class="row">
                    <div class="col-lg-8">
                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <div class="card shadow-sm border-0 h-100">
                                    <div class="card-header fw-bold text-primary">Profil Bilgileri</div>
                                    <div class="card-body">
                                        <form id="updateProfileForm">
                                            <div class="mb-3">
                                                <label class="form-label fw-bold">Kullanıcı Adı</label>
                                                <input type="text" class="form-control" id="settingsName" required>
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label fw-bold">Biyografi</label>
                                                <textarea class="form-control" id="settingsBio" rows="4" placeholder="Kendinden bahset..."></textarea>
                                            </div>
                                            
                                            <hr>
                                            <h6 class="fw-bold text-success"><i class="fas fa-medal me-1"></i> Sergilenecek Başarılar (Maks. 3)</h6>
                                            <div id="achievementSelectionArea" class="p-2 border rounded">
                                                <div class="text-muted small">Kazanılmış başarılar yükleniyor...</div>
                                            </div>
                                            <div id="achievementError" class="form-text text-danger small"></div>
                                            <hr>

                                            <div class="alert alert-info small" role="alert">
                                                Kullanıcı adını değiştirdiğinizde, paylaştığınız içerikler ve yorumlar da bu yeni ada göre güncellenecektir.
                                            </div>
                                            <button type="submit" class="btn btn-primary w-100">Profili Kaydet</button>
                                        </form>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6 mb-4">
                                 <div class="card shadow-sm border-0 h-100">
                                    <div class="card-header fw-bold text-danger">Şifre ve Güvenlik</div>
                                    <div class="card-body">
                                        <form id="updatePasswordForm">
                                            <div class="mb-3">
                                                <label class="form-label">Mevcut Şifre</label>
                                                <input type="password" class="form-control" id="oldPass" required>
                                            </div>
                                            <div class="mb-4">
                                                <label class="form-label">Yeni Şifre</label>
                                                <input type="password" class="form-control" id="newPass" required minlength="6">
                                            </div>
                                            <button type="submit" class="btn btn-danger w-100">Şifreyi Değiştir</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-4">
                        <div class="mb-4">
                            <div class="card shadow-sm border-0">
                            <div class="card-header fw-bold">Gizlilik</div>
                                <div class="card-body d-flex justify-content-between align-items-center">
                                    <div>
                                        <strong class="d-block"><i class="fas fa-lock me-1"></i> Gizli Hesap</strong>
                                        <span class="small text-muted">Sadece takipçiler görebilir.</span>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="privacySwitch" style="width: 3em; height: 1.5em;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="data_store.js"></script>
    <script src="achievements_data.js"></script> 
    <script src="user_achievements.js"></script> 
    <script src="social-media.js"></script> 
    <script src="settings.js"></script>
    <script>
        // data_store.js ve social-media.js'teki global fonksiyonlar
        function logout() { 
            if (typeof window.logout === 'function') {
                window.logout(); // social-media.js'teki logout'u çağır
            } else {
                sessionStorage.clear(); 
                window.location.href='login.html'; 
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('sidebarToggleMobile')?.addEventListener('click', () => {
                document.body.classList.toggle('sidebar-toggled');
            });
            
            // Admin Panel Link Kontrolü (Sürekli görünür olması için)
            const adminPanelLink = document.getElementById('adminPanelLink');
            const userRole = sessionStorage.getItem('CURRENT_USER_ROLE') || 'member';
            if (adminPanelLink) {
                 adminPanelLink.style.display = (userRole !== 'member') ? 'inline' : 'none';
            }
        });
    </script>
</body>
</html>